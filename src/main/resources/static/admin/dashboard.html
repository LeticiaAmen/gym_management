<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>GYM - Panel de Administraci√≥n</title>
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/components.css">
    <link rel="stylesheet" href="/css/dashboard.css">
</head>
<body class="with-navbar">
  <!-- Navbar Moderno -->
  <nav class="navbar">
    <a href="/admin/dashboard.html" class="navbar-brand">GYM BOX</a>

    <ul class="navbar-nav">
      <li><a href="#" data-section="dashboard" class="active">Panel</a></li>
      <li><a href="#" data-section="clients">Clientes</a></li>
      <li><a href="#" data-section="payments">Pagos</a></li>
      <li><a href="#" data-section="reports">Reportes</a></li>
    </ul>

    <div class="navbar-user">
      <button onclick="logout()" class="btn-logout">Cerrar sesi√≥n</button>
    </div>
  </nav>

  <div class="container">
    <!-- Secci√≥n Dashboard Principal -->
    <section id="dashboard-section" class="section">
      <div class="dashboard-header">
        <h1>¬°Bienvenido de nuevo!</h1>
        <p class="dashboard-subtitle">Esto es lo que est√° pasando en GYM BOX hoy.</p>
      </div>

      <!-- Tarjetas de estad√≠sticas -->
      <div class="stats-grid">
        <div class="stat-card active-clients">
          <div class="stat-content">
            <div class="stat-info">
              <h3>Clientes activos</h3>
              <span class="stat-number" id="active-clients-count">--</span>
            </div>
            <div class="stat-icon">
              <i class="icon-users">üë•</i>
            </div>
          </div>
        </div>

        <div class="stat-card pending-payments">
          <div class="stat-content">
            <div class="stat-info">
              <h3>Pagos pendientes</h3>
              <span class="stat-number" id="pending-payments-count">--</span>
            </div>
            <div class="stat-icon">
              <i class="icon-warning">‚ö†Ô∏è</i>
            </div>
          </div>
        </div>
      </div>

      <!-- Actividad reciente -->
      <div class="recent-activity">
        <h2 style="color: white">Actividad reciente</h2>
        <div class="activity-list" id="recent-activity-list">
          <!-- Los datos se cargar√°n din√°micamente con JavaScript -->
        </div>
      </div>
    </section>

    <!-- Secci√≥n Clientes -->
    <section id="clients-section" class="section" style="display:none">
      <div class="section-header">
        <div class="section-title">
          <h1>Gesti√≥n de Clientes</h1>
          <p class="section-subtitle">Administra tus socios y su informaci√≥n</p>
        </div>
        <button onclick="showClientForm()" class="btn-new-action">
          <span class="btn-icon">+</span>
          Nuevo cliente
        </button>
      </div>

      <!-- Panel de filtros amigable -->
      <div class="filters clients-filters">
        <div class="filter-group">
          <label for="client-q">B√∫squeda</label>
          <input type="text" id="client-q" class="search-input" placeholder="Nombre, apellido o email‚Ä¶" aria-label="Buscar clientes por nombre, apellido o email" />
        </div>
        <div class="filter-group">
          <label for="client-active">Estado del cliente</label>
          <select id="client-active" aria-label="Filtrar por estado de cliente">
            <option value="">Todos</option>
            <option value="true">Activos</option>
            <option value="false">Inactivos</option>
          </select>
        </div>
        <div class="filter-group">
          <label for="client-payment">Estado de pago</label>
          <select id="client-payment" aria-label="Filtrar por estado de pago">
            <option value="">Pago: todos</option>
            <option value="PENDING">Pendiente</option>
            <option value="UP_TO_DATE">Al d√≠a</option>
            <option value="EXPIRED">Vencido</option>
          </select>
        </div>
        <button onclick="filterClients()" class="btn-filter-clients" title="Aplicar filtros">Filtrar</button>
        <button onclick="clearClientFilters()" class="btn-clear-clients" title="Limpiar filtros">Limpiar</button>
        <p class="filters-hint">Todos los filtros son opcionales. Puedes combinar b√∫squeda por texto con estado del cliente y de pago.</p>
      </div>

      <div class="clients-table-container">
        <div class="table-header">
          <h3>Todos los clientes (<span id="clients-count">--</span>)</h3>
        </div>

        <div class="modern-table-wrapper">
          <table id="clients-table" class="modern-table">
            <thead>
              <tr>
                <th>Nombre</th>
                <th>Apellido</th>
                <th>Email</th>
                <th>Tel√©fono</th>
                <th>Estado</th>
                <th>Fecha</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <!-- Los datos se cargar√°n din√°micamente con JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Secci√≥n Pagos -->
    <section id="payments-section" class="section" style="display:none">
      <div class="section-header">
        <div class="section-title">
          <h1>Gesti√≥n de Pagos</h1>
          <p class="section-subtitle">Consulta, registra y anula pagos de los clientes</p>
        </div>
        <button onclick="showPaymentForm()" class="btn-new-action">
          <span class="btn-icon">+</span>
          Registrar pago
        </button>
      </div>
      <div class="filters payments-filters">
        <div class="filter-group">
          <label for="payment-client-q">Cliente</label>
          <input id="payment-client-q" list="payment-client-options" placeholder="Nombre, apellido o email‚Ä¶" aria-label="Filtrar pagos por cliente (nombre, apellido o email)" title="Escribe nombre, apellido o email del cliente" />
          <datalist id="payment-client-options"></datalist>
        </div>
        <div class="filter-group">
          <label for="date-from">Desde (incluye)</label>
          <input type="date" id="date-from" aria-label="Fecha m√≠nima (incluye)" placeholder="Desde" title="Fecha m√≠nima de b√∫squeda (incluye el d√≠a)" />
        </div>
        <div class="filter-group">
          <label for="date-to">Hasta (incluye)</label>
          <input type="date" id="date-to" aria-label="Fecha m√°xima (incluye)" placeholder="Hasta" title="Fecha m√°xima de b√∫squeda (incluye el d√≠a)" />
        </div>
        <div class="filter-group">
          <label for="payment-state">Estado</label>
          <select id="payment-state" aria-label="Filtrar por estado de pago" title="Estado del pago (opcional)">
            <option value="">Todos los estados</option>
            <option value="PENDING">Pendiente</option>
            <option value="UP_TO_DATE">Al d√≠a</option>
            <option value="EXPIRED">Vencido</option>
            <option value="VOIDED">Anulado</option>
          </select>
        </div>
        <button onclick="filterPayments()" class="btn-filter-payments" title="Aplicar filtros">Filtrar</button>
        <button id="btn-clear-payments" onclick="clearPaymentFilters()" class="btn-clear-payments" title="Limpiar filtros">Limpiar</button>
        <p class="filters-hint">Consejo: todos los filtros son opcionales. Usa "Desde/Hasta" para acotar por fecha de pago.</p>
      </div>
      <div class="modern-table-wrapper">
        <table id="payments-table" class="modern-table">
          <thead>
            <tr>
              <th>Cliente</th>
              <th>Monto</th>
              <th>M√©todo</th>
              <th>Fecha Pago</th>
              <th>Tiempo</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- Secci√≥n Reportes -->
    <section id="reports-section" class="section" style="display:none">
      <div class="section-header">
        <div class="section-title">
          <h1>Reportes</h1>
          <p class="section-subtitle">Resumen r√°pido de membres√≠as e ingresos</p>
        </div>
      </div>

      <div class="report-stats-grid">
        <div class="stat-card expired-memberships">
          <div class="stat-content">
            <div class="stat-info">
              <h3>Membres√≠as expiradas</h3>
              <span class="stat-number" id="report-expired-count">--</span>
              <div style="margin-top: 0.75rem;">
                <button class="btn-new-action" onclick="getOverdueReport()">
                  <span class="btn-icon">üîç</span>
                  Ver clientes
                </button>
              </div>
            </div>
            <div class="stat-icon">‚õî</div>
          </div>
        </div>
        <div class="stat-card expiring-memberships">
          <div class="stat-content">
            <div class="stat-info">
              <h3>Por vencer (7 d√≠as)</h3>
              <span class="stat-number" id="report-expiring-count">--</span>
              <div style="margin-top: 0.75rem;">
                <button class="btn-new-action" onclick="getExpiringReport()">
                  <span class="btn-icon">üîç</span>
                  Ver clientes
                </button>
              </div>
            </div>
            <div class="stat-icon">‚è≥</div>
          </div>
        </div>
        <div class="stat-card monthly-income">
          <div class="stat-content">
            <div class="stat-info">
              <h3>Ingresos del mes</h3>
              <span class="stat-number" id="report-month-income">--</span>
            </div>
            <div class="stat-icon">üí∞</div>
          </div>
        </div>
      </div>

      <div id="report-results" class="report-results"></div>
    </section>
  </div>

  <!-- Modales -->
  <div id="client-modal" class="modal">
    <!-- Formulario de cliente -->
  </div>
  <div id="payment-modal" class="modal">
    <!-- Formulario de pago -->
  </div>
  <div id="pause-modal" class="modal">
    <!-- Formulario de pausa -->
  </div>

  <!-- Modal de confirmaci√≥n -->
  <div id="confirmation-modal" class="confirmation-modal">
    <div class="confirmation-content">
      <div class="confirmation-header">
        <div id="confirmation-icon" class="confirmation-icon warning">
          ‚ö†Ô∏è
        </div>
        <h3 id="confirmation-title" class="confirmation-title">Confirmar acci√≥n</h3>
      </div>
      <p id="confirmation-message" class="confirmation-message">
        ¬øEst√°s seguro de que quieres realizar esta acci√≥n?
      </p>
      <div class="confirmation-actions">
        <button id="confirmation-cancel" class="btn-cancel">Cancelar</button>
        <button id="confirmation-confirm" class="btn-confirm">Confirmar</button>
      </div>
    </div>
  </div>

  <script type="module" src="/js/api.js?v=20250916"></script>
  <script type="module" src="/js/ui.js?v=20250917"></script>
  <script src="/js/navbar.js?v=20250915"></script>
</body>
</html>